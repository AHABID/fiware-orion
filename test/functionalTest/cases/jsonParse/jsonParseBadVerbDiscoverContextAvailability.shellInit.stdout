{ "dropped" : "testharness", "ok" : 1 }
T@09:46:05  paConfigActions[727]: setting trace levels to '0-255'
T@09:46:05  paConfigActions[728]: Leaving function paConfigActions
E@09:46:05  exitFunc[1009]: unlink(/tmp/orion_9999.pid): No such file or directory
T@09:46:05  semInit[61]: Initialized 'req' semaphore
T@09:46:05  semInit[62]: Initialized 'mongo' semaphore
T@09:46:05  mongoSemTake[90]: mongoConnect taking the 'mongo' semaphore for 'connecting to mongo'
T@09:46:05  mongoSemTake[92]: mongoConnect has the 'mongo' semaphore
T@09:46:05  mongoConnect[152]: mongo version server: 2.4.9 (mayor: 2, minor: 4, extra: 9)
T@09:46:05  mongoSemGive[118]: mongoConnect gives the 'mongo' semaphore for 'connecting to mongo'
F@09:46:05  ***[1063]: Connected to mongo at localhost:testharness
T@09:46:05  ensureLocationIndex[381]: ensuring 2dsphere index on location.coords (tenant )
T@09:46:05  recoverOntimeIntervalThreads[398]: query() in 'testharness.csubs' collection: '{ conditions.type: "ONTIMEINTERVAL" }'
T@09:46:05  mongoSemTake[90]: recoverOntimeIntervalThreads taking the 'mongo' semaphore for 'query in SubscribeContextCollection'
T@09:46:05  mongoSemTake[92]: recoverOntimeIntervalThreads has the 'mongo' semaphore
T@09:46:05  mongoSemGive[118]: recoverOntimeIntervalThreads gives the 'mongo' semaphore for 'query in SubscribeContextCollection'
V@09:46:05  restStart[569]: Starting HTTP daemon on IPv4 0.0.0.0 port 9999
V@09:46:05  restStart[611]: Starting HTTP daemon on IPv6 :: port 9999
T@09:46:06  connectionTreat[438]: notifyFormat: ''
T@09:46:06  httpHeaderGet[137]: HTTP Header:   User-Agent: curl/7.26.0
T@09:46:06  httpHeaderGet[137]: HTTP Header:   Host: localhost:9999
T@09:46:06  httpHeaderGet[137]: HTTP Header:   Content-Type: application/json
T@09:46:06  httpHeaderGet[137]: HTTP Header:   Accept: application/json
T@09:46:06  httpHeaderGet[137]: HTTP Header:   Content-Length: 485
T@09:46:06  connectionTreat[442]: HTTP tenant: ''
T@09:46:06  connectionTreat[470]: 'default' value for notifyFormat (ciP->outFormat == 2)): 'JSON'
T@09:46:06  restService[179]: Parsing payload for URL '/NGSI9/registerContext', method 'POST', service vector index: 0
T@09:46:06  payloadParse[53]: parsing data for service 'RegisterContextRequest'. Method: 'POST'
T@09:46:06  payloadParse[54]: outFormat: JSON
2@09:46:06  jsonRequestGet[121]: Found jsonRequest of type 1, method 'POST' - index 0 (/contextRegistrations)
T@09:46:06  jsonTreat[140]: Treating a JSON request: '{ "contextRegistrations": [ { "entities": [ { "type": "Room", "isPattern": "false", "id": "ConferenceRoom" }, { "type": "Room", "isPattern": "false", "id": "OfficeRoom" } ], "attributes": [ { "name": "temperature", "type": "degree", "isDomain": "false", "metadatas": [ { "name": "ID", "type": "string", "value": "1110" } ] } ], "metadatas": [ { "name": "ID", "type": "string", "value": "2212" } ], "providingApplication": "http://192.168.100.1:70/application" } ], "duration": "PT1M" }'
T@09:46:06  jsonTreat[155]: Treating 'registerContextRequest' request
T@09:46:06  treat[107]: Treating path '/contextRegistrations', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations': ''
T@09:46:06  jsonNullTreat[41]: Not treating JSON node '/contextRegistrations'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration': ''
T@09:46:06  contextRegistration[53]: /contextRegistrations/contextRegistration: 
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities': ''
T@09:46:06  jsonNullTreat[41]: Not treating JSON node '/contextRegistrations/contextRegistration/entities'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities/entity', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities/entity': ''
T@09:46:06  entityId[66]: /contextRegistrations/contextRegistration/entities/entity: 
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities/entity'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities/entity/type', value 'Room'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities/entity/type': 'Room'
T@09:46:06  entityIdType[102]: Set 'type' to 'Room' for an entity
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities/entity/type'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities/entity/isPattern', value 'false'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities/entity/isPattern': 'false'
T@09:46:06  entityIdIsPattern[115]: Got an entityId:isPattern: 'false'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities/entity/isPattern'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities/entity/id', value 'ConferenceRoom'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities/entity/id': 'ConferenceRoom'
T@09:46:06  entityIdId[88]: Set 'id' to 'ConferenceRoom' for an entity
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities/entity/id'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities/entity', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities/entity': ''
T@09:46:06  entityId[66]: /contextRegistrations/contextRegistration/entities/entity: 
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities/entity'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities/entity/type', value 'Room'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities/entity/type': 'Room'
T@09:46:06  entityIdType[102]: Set 'type' to 'Room' for an entity
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities/entity/type'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities/entity/isPattern', value 'false'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities/entity/isPattern': 'false'
T@09:46:06  entityIdIsPattern[115]: Got an entityId:isPattern: 'false'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities/entity/isPattern'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/entities/entity/id', value 'OfficeRoom'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/entities/entity/id': 'OfficeRoom'
T@09:46:06  entityIdId[88]: Set 'id' to 'OfficeRoom' for an entity
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/entities/entity/id'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes': ''
T@09:46:06  jsonNullTreat[41]: Not treating JSON node '/contextRegistrations/contextRegistration/attributes'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute': ''
T@09:46:06  crAttribute[136]: /contextRegistrations/contextRegistration/attributes/attribute: 
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute/name', value 'temperature'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute/name': 'temperature'
T@09:46:06  craName[154]: Set 'name' to 'temperature' for a contextRegistrationAttribute
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute/name'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute/type', value 'degree'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute/type': 'degree'
T@09:46:06  craType[168]: Set 'type' to 'degree' for a contextRegistrationAttribute
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute/type'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute/isDomain', value 'false'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute/isDomain': 'false'
T@09:46:06  craIsDomain[185]: Set 'isDomain' to 'false' for a contextRegistrationAttribute
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute/isDomain'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute/metadatas', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas': ''
T@09:46:06  jsonNullTreat[41]: Not treating JSON node '/contextRegistrations/contextRegistration/attributes/attribute/metadatas'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata': ''
T@09:46:06  craMetadata[198]: Creating a metadata
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/name', value 'ID'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/name': 'ID'
T@09:46:06  craMetadataName[219]: Got a metadata name: 'ID'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/name'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/type', value 'string'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/type': 'string'
T@09:46:06  craMetadataType[233]: Got a metadata type: 'string'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/type'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/value', value '1110'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/value': '1110'
T@09:46:06  craMetadataValue[247]: Got a metadata value: '1110'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/attributes/attribute/metadatas/metadata/value'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/metadatas', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/metadatas': ''
T@09:46:06  jsonNullTreat[41]: Not treating JSON node '/contextRegistrations/contextRegistration/metadatas'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/metadatas'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/metadatas/metadata', value ''
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/metadatas/metadata': ''
T@09:46:06  regMetadata[261]: Creating a reg metadata
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/metadatas/metadata'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/metadatas/metadata/name', value 'ID'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/metadatas/metadata/name': 'ID'
T@09:46:06  regMetadataName[280]: Got a reg metadata name: 'ID'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/metadatas/metadata/name'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/metadatas/metadata/type', value 'string'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/metadatas/metadata/type': 'string'
T@09:46:06  regMetadataType[294]: Got a reg metadata type: 'string'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/metadatas/metadata/type'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/metadatas/metadata/value', value '2212'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/metadatas/metadata/value': '2212'
T@09:46:06  regMetadataValue[308]: Got a reg metadata value: '2212'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/metadatas/metadata/value'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/contextRegistrations/contextRegistration/providingApplication', value 'http://192.168.100.1:70/application'
T@09:46:06  treat[113]: calling treat function for '/contextRegistrations/contextRegistration/providingApplication': 'http://192.168.100.1:70/application'
T@09:46:06  providingApplication[322]: Got a providing application: 'http://192.168.100.1:70/application'
T@09:46:06  treat[115]: called treat function for '/contextRegistrations/contextRegistration/providingApplication'. result: 'OK'
T@09:46:06  treat[107]: Treating path '/duration', value 'PT1M'
T@09:46:06  treat[113]: calling treat function for '/duration': 'PT1M'
T@09:46:06  duration[336]: Got a duration: 'PT1M'. Saving in 0x7f2427312398
T@09:46:06  duration[338]: Got a duration: SAVED!
T@09:46:06  treat[115]: called treat function for '/duration'. result: 'OK'
T@09:46:06  jsonTreat[192]: Calling check for JSON parsed tree (registerContextRequest)
T@09:46:06  ~RegisterContextResponse[56]: destroyed
T@09:46:06  payloadParse[69]: result: 'OK'
T@09:46:06  payloadParse[70]: outFormat: JSON
T@09:46:06  restService[182]: payloadParse returns 'OK'
T@09:46:06  restService[197]: Treating service POST /NGSI9/registerContext
T@09:46:06  restService[237]: tenant: ''
T@09:46:06  reqSemTake[75]: mongoRegisterContext taking the 'req' semaphore for 'ngsi9 register request'
T@09:46:06  reqSemTake[77]: mongoRegisterContext has the 'req' semaphore
T@09:46:06  mongoRegisterContext[51]: Register Context Request
T@09:46:06  processRegisterContext[342]: Registration expiration: 1401788826
T@09:46:06  processRegisterContext[380]: Entity registration: {id: ConferenceRoom, type: Room}
T@09:46:06  processRegisterContext[380]: Entity registration: {id: OfficeRoom, type: Room}
T@09:46:06  processRegisterContext[394]: Attribute registration: {name: temperature, type: degree, isDomain: false}
T@09:46:06  processRegisterContext[406]: providingApplication registration: http://192.168.100.1:70/application
T@09:46:06  addTriggeredSubscriptions[255]: JS function: function(){enId = [ "ConferenceRoom" ,"OfficeRoom" ];enType = [ "Room" ,"Room" ];for (var i=0; i < this.entities.length; i++) {if (this.entities[i].isPattern == "true") {for (var j=0; j < enId.length; j++) {if (enId[j].match(this.entities[i].id) && this.entities[i].type == enType[j]) {return true; }}}}return false; }
T@09:46:06  addTriggeredSubscriptions[268]: query() in 'testharness.casubs' collection: '{ $or: [ { entities: { $in: [ { id: "ConferenceRoom", type: "Room", isPattern: "false" }, { id: "OfficeRoom", type: "Room", isPattern: "false" } ] }, $or: [ { attrs: { $in: [ "temperature" ] } }, { attrs: { $size: 0 } } ], expiration: { $gt: 1401788766 } }, { entities.isPattern: "true", expiration: { $gt: 1401788766 }, $where: function(){enId = [ "ConferenceRoom" ,"OfficeRoom" ];enType = [ "Room"... } ] }'
T@09:46:06  mongoSemTake[90]: addTriggeredSubscriptions taking the 'mongo' semaphore for 'query in SubscribeContextAvailabilityCollection'
T@09:46:06  mongoSemTake[92]: addTriggeredSubscriptions has the 'mongo' semaphore
T@09:46:06  mongoSemGive[118]: addTriggeredSubscriptions gives the 'mongo' semaphore for 'query in SubscribeContextAvailabilityCollection'
T@09:46:06  processRegisterContext[422]: upsert update() in 'testharness.registrations' collection: '{ _id: ObjectId('538d995e813cbf3d070ff2d4'), expiration: 1401788826, contextRegistration: [ { entities: [ { id: "ConferenceRoom", type: "Room" }, { id: "OfficeRoom", type: "Room" } ], attrs: [ { name: "temperature", type: "degree", isDomain: "false" } ], providingApplication: "http://192.168.100.1:70/application" } ] }'
T@09:46:06  mongoSemTake[90]: processRegisterContext taking the 'mongo' semaphore for 'update in RegistrationsCollection'
T@09:46:06  mongoSemTake[92]: processRegisterContext has the 'mongo' semaphore
T@09:46:06  mongoSemGive[118]: processRegisterContext gives the 'mongo' semaphore for 'update in RegistrationsCollection'
T@09:46:06  reqSemGive[104]: mongoRegisterContext gives the 'req' semaphore for 'ngsi9 register request'
T@09:46:06  ~RegisterContextResponse[56]: destroyed
T@09:46:06  release[153]: Releasing Metadata 0
T@09:46:06  release[153]: Releasing Metadata 0
T@09:46:06  restReply[65]: Response 1: responding with 75 bytes, Status Code 200
T@09:46:06  restReply[66]: Response payload: '{
  "duration" : "PT1M",
  "registrationId" : "538d995e813cbf3d070ff2d4"
}
'
T@09:46:06  ~RegisterContextResponse[56]: destroyed
T@09:46:06  connectionTreat[438]: notifyFormat: ''
T@09:46:06  httpHeaderGet[137]: HTTP Header:   User-Agent: curl/7.26.0
T@09:46:06  httpHeaderGet[137]: HTTP Header:   Host: localhost:9999
T@09:46:06  httpHeaderGet[137]: HTTP Header:   Content-Type: application/json
T@09:46:06  httpHeaderGet[137]: HTTP Header:   Accept: application/json
T@09:46:06  httpHeaderGet[137]: HTTP Header:   Content-Length: 346
T@09:46:06  connectionTreat[442]: HTTP tenant: ''
T@09:46:06  connectionTreat[470]: 'default' value for notifyFormat (ciP->outFormat == 2)): 'JSON'
T@09:46:06  restService[197]: Treating service * /NGSI9/discoverContextAvailability
T@09:46:06  restService[237]: tenant: ''
W@09:46:06  badVerbPostOnly[48]: bad verb for url '/NGSI9/discoverContextAvailability', method 'BAD_VERB'
T@09:46:06  restReply[65]: Response 2: responding with 0 bytes, Status Code 405
T@09:46:06  restReply[66]: Response payload: ''
T@09:46:06  ~RegisterContextResponse[56]: destroyed
F@09:46:06  ***[981]: In sigHandler - caught signal 15
X@09:46:06  sigHandler[987]: Received signal 15
E@09:46:06  exitFunc[1009]: unlink(/tmp/orion_9999.pid): No such file or directory


1 ContextRegistrationsContext Registration 0:
2 EntityIds:
  Entity Id 0:
    Id:         ConferenceRoom
    Type:       Room
    isPattern:  false
  Entity Id 1:
    Id:         OfficeRoom
    Type:       Room
    isPattern:  false
1 ContextRegistrationAttributes  Attribute 0:
    Name:       temperature
    Type:       degree
    isDomain:   false
1 Attribute Metadata
    Attribute Metadata 0:
      Name:     ID
      Type:     string
      Value:    1110
1 Registration Metadata
  Registration Metadata 0:
    Name:     ID
    Type:     string
    Value:    2212
  ProvidingApplication: http://192.168.100.1:70/application
Duration: PT1M
No RegistrationId


1 ContextRegistrationsContext Registration 0:
2 EntityIds:
  Entity Id 0:
    Id:         ConferenceRoom
    Type:       Room
    isPattern:  false
  Entity Id 1:
    Id:         OfficeRoom
    Type:       Room
    isPattern:  false
1 ContextRegistrationAttributes  Attribute 0:
    Name:       temperature
    Type:       degree
    isDomain:   false
1 Attribute Metadata
    Attribute Metadata 0:
      Name:     ID
      Type:     string
      Value:    1110
1 Registration Metadata
  Registration Metadata 0:
    Name:     ID
    Type:     string
    Value:    2212
  ProvidingApplication: http://192.168.100.1:70/application
Duration: PT1M
No RegistrationId
