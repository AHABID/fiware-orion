{ "dropped" : "testharness", "ok" : 1 }
T@09:37:19  paConfigActions[722]: setting trace levels to '0-255'
T@09:37:19  paConfigActions[723]: Leaving function paConfigActions
E@09:37:19  exitFunc[531]: unlink(/tmp/orion_9999.pid): No such file or directory
F@09:37:19  ***[580]: Opening mongo connection
F@09:37:19  ***[589]: Connected to localhost:testharness as user 
T@09:37:19  recoverOntimeIntervalThreads[143]: query() in 'testharness.csubs' collection: '{ conditions.type: "ONTIMEINTERVAL" }'
T@09:37:19  restStart[483]: Starting http daemon on IP 0.0.0.0 port 9999
T@09:37:19  restStart[513]: Starting http daemon on IPv6 :: port 9999
accumulator running as PID 15693
accumulator running as PID 15693
T@09:37:24  connectionTreat[300]: HTTP method: GET, URL: /version, version: HTTP/1.1
T@09:37:24  httpHeaderGet[77]: HTTP Header:   User-Agent: curl/7.26.0
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Host: :::9999
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Accept: */*
T@09:37:24  connectionTreat[278]: Request 1, callNo == 2: 0 bytes of payload (of 0)
T@09:37:24  connectionTreat[373]: method: GET
T@09:37:24  connectionTreat[398]: Not post-processing 0 bytes of data - setting upload_data_size to ZERO?
T@09:37:24  restService[150]: Treating service GET /version
T@09:37:24  restReply[105]: Response 1: responding with 263 bytes, Status Code 200
T@09:37:24  restReply[106]: Response payload: '<orion>
  <version>0.9.1-next</version>
  <uptime>0 d, 0 h, 0 m, 5 s</uptime>
  <git_hash>6a69cd0d46c0694d3c8d75fa14ac9837ea01c6ba</git_hash>
  <compile_time>nodate</compile_time>
  <compiled_by>fermin</compiled_by>
  <compiled_in>oriondeb</compiled_in>
</orion>
'
T@09:37:24  ~RegisterContextResponse[56]: destroyed
T@09:37:24  requestCompleted[128]: Request Completed. Read 0 bytes of 0
T@09:37:24  connectionTreat[300]: HTTP method: GET, URL: /version, version: HTTP/1.1
T@09:37:24  httpHeaderGet[77]: HTTP Header:   User-Agent: curl/7.26.0
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Host: localhost:9999
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Accept: */*
T@09:37:24  connectionTreat[278]: Request 2, callNo == 2: 0 bytes of payload (of 0)
T@09:37:24  connectionTreat[373]: method: GET
T@09:37:24  connectionTreat[398]: Not post-processing 0 bytes of data - setting upload_data_size to ZERO?
T@09:37:24  restService[150]: Treating service GET /version
T@09:37:24  restReply[105]: Response 2: responding with 263 bytes, Status Code 200
T@09:37:24  restReply[106]: Response payload: '<orion>
  <version>0.9.1-next</version>
  <uptime>0 d, 0 h, 0 m, 5 s</uptime>
  <git_hash>6a69cd0d46c0694d3c8d75fa14ac9837ea01c6ba</git_hash>
  <compile_time>nodate</compile_time>
  <compiled_by>fermin</compiled_by>
  <compiled_in>oriondeb</compiled_in>
</orion>
'
T@09:37:24  ~RegisterContextResponse[56]: destroyed
T@09:37:24  requestCompleted[128]: Request Completed. Read 0 bytes of 0
T@09:37:24  connectionTreat[300]: HTTP method: POST, URL: /NGSI10/subscribeContext, version: HTTP/1.1
T@09:37:24  httpHeaderGet[77]: HTTP Header:   User-Agent: curl/7.26.0
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Host: :::9999
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Accept: */*
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Content-Type: application/xml
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Content-Length: 678
T@09:37:24  connectionTreat[278]: Request 3, callNo == 2: 678 bytes of payload (of 678)
T@09:37:24  connectionTreat[373]: method: POST
T@09:37:24  connectionTreat[398]: Not post-processing 678 bytes of data - setting upload_data_size to ZERO?
T@09:37:24  connectionTreat[278]: Request 3, callNo == 3: 0 bytes of payload (of 678)
T@09:37:24  connectionTreat[373]: method: POST
T@09:37:24  connectionTreat[426]: Calling restService '/NGSI10/subscribeContext' with payload: '<?xml version="1.0"?><subscribeContextRequest>  <entityIdList>        <entityId type="Room" isPattern="false">          <id>OfficeRoom6</id>        </entityId>  </entityIdList>  <attributeList>        <attribute>temperature</attribute>        <attribute>lightstatus</attribute>  </attributeList>  <reference>http://:::9977/notify</reference>  <duration>PT1H</duration>  <notifyConditions>        <notifyCondition>          <type>ONCHANGE</type>          <condValueList>                <condValue>temperature</condValue>                <condValue>lightstatus</condValue>          </condValueList>                  </notifyCondition>  </notifyConditions></subscribeContextRequest>'
T@09:37:24  restService[121]: ix 0: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 1: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 2: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 3: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 4: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 5: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 6: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 7: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 8: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 9: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 10: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 11: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 12: component 1 is not a match ('subscribeContext' != 'updateContext')
T@09:37:24  restService[121]: ix 13: component 1 is not a match ('subscribeContext' != 'updateContext')
T@09:37:24  restService[121]: ix 14: component 1 is not a match ('subscribeContext' != 'queryContext')
T@09:37:24  restService[121]: ix 15: component 1 is not a match ('subscribeContext' != 'queryContext')
T@09:37:24  restService[133]: Parsing payload for URL '/NGSI10/subscribeContext', method 'POST', service vector index: 16
T@09:37:24  payloadParse[51]: parsing data for service 'SubscribeContextRequest'. Method: 'POST'
T@09:37:24  payloadParse[52]: outFormat: XML
T@09:37:24  payloadParse[56]: Calling xmlTreat for service request 12, payloadWord 'subscribeContextRequest'
T@09:37:24  nullTreat[99]: Not treating node 'subscribeContextRequest'
T@09:37:24  nullTreat[99]: Not treating node 'entityIdList'
T@09:37:24  entityId[51]: Got an entityId
T@09:37:24  entityIdParse[116]: Got a type for an entity: 'Room'
T@09:37:24  entityIdParse[121]: Got an isPattern for an entity: 'false'
T@09:37:24  entityIdId[75]: Got an entityId:id: 'OfficeRoom6'
T@09:37:24  nullTreat[99]: Not treating node 'attributeList'
T@09:37:24  attribute[88]: Got an attribute
T@09:37:24  attribute[88]: Got an attribute
T@09:37:24  reference[172]: Got a reference: 'http://:::9977/notify'
T@09:37:24  duration[185]: Got a duration: 'PT1H'
T@09:37:24  nullTreat[99]: Not treating node 'notifyConditions'
T@09:37:24  notifyCondition[197]: Got a Notify Condition
T@09:37:24  notifyConditionType[225]: Got a Notify Condition Type: 'ONCHANGE'
T@09:37:24  nullTreat[99]: Not treating node 'condValueList'
T@09:37:24  condValue[238]: Got a Cond Value: 'temperature'
T@09:37:24  condValue[238]: Got a Cond Value: 'lightstatus'
T@09:37:24  check[45]: In Restriction::check
T@09:37:24  check[48]: Restriction::check returns OK (counter == 0)
T@09:37:24  ~SubscribeContextResponse[38]: destroyed
T@09:37:24  payloadParse[67]: result: 'OK'
T@09:37:24  payloadParse[68]: outFormat: XML
T@09:37:24  restService[135]: payloadParse returns 'OK'
T@09:37:24  restService[150]: Treating service POST /NGSI10/subscribeContext
T@09:37:24  mongoSubscribeContext[48]: Subscribe Context Request
T@09:37:24  mongoSubscribeContext[59]: Subscription expiration: 1391769444
T@09:37:24  processEntitityPatternFalse[376]: Entity query token (isPattern=false): {id: OfficeRoom6, type: Room}
T@09:37:24  entitiesQuery[455]: Attribute query token: 'temperature'
T@09:37:24  entitiesQuery[455]: Attribute query token: 'lightstatus'
T@09:37:24  entitiesQuery[487]: query() in 'testharness.entities' collection: '{ $or: [ { _id: { $in: [ { id: "OfficeRoom6", type: "Room" } ] } } ], attrs.name: { $in: [ "temperature", "lightstatus" ] } }'
T@09:37:24  mongoSubscribeContext[111]: insert() in 'testharness.csubs' collection: '{ _id: ObjectId('52f4a9544ab2dfa2ff342f87'), expiration: 1391769444, reference: "http://:::9977/notify", entities: [ { id: "OfficeRoom6", type: "Room", isPattern: "false" } ], attrs: [ "temperature", "lightstatus" ], conditions: [ { type: "ONCHANGE", value: [ "temperature", "lightstatus" ] } ], format: "XML" }'
T@09:37:24  ~SubscribeContextResponse[38]: destroyed
T@09:37:24  restReply[105]: Response 3: responding with 192 bytes, Status Code 200
T@09:37:24  restReply[106]: Response payload: '<subscribeContextResponse>
  <subscribeResponse>
    <subscriptionId>52f4a9544ab2dfa2ff342f87</subscriptionId>
    <duration>PT1H</duration>
  </subscribeResponse>
</subscribeContextResponse>
'
T@09:37:24  ~RegisterContextResponse[56]: destroyed
T@09:37:24  requestCompleted[128]: Request Completed. Read 678 bytes of 678
T@09:37:24  connectionTreat[300]: HTTP method: POST, URL: /NGSI10/subscribeContext, version: HTTP/1.1
T@09:37:24  httpHeaderGet[77]: HTTP Header:   User-Agent: curl/7.26.0
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Host: localhost:9999
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Accept: */*
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Content-Type: application/xml
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Content-Length: 675
T@09:37:24  connectionTreat[278]: Request 4, callNo == 2: 675 bytes of payload (of 675)
T@09:37:24  connectionTreat[373]: method: POST
T@09:37:24  connectionTreat[398]: Not post-processing 675 bytes of data - setting upload_data_size to ZERO?
T@09:37:24  connectionTreat[278]: Request 4, callNo == 3: 0 bytes of payload (of 675)
T@09:37:24  connectionTreat[373]: method: POST
T@09:37:24  connectionTreat[426]: Calling restService '/NGSI10/subscribeContext' with payload: '<?xml version="1.0"?><subscribeContextRequest>  <entityIdList>        <entityId type="Room" isPattern="false">          <id>OfficeRoom4</id>        </entityId>  </entityIdList>  <attributeList>        <attribute>temperature</attribute>        <attribute>lightstatus</attribute>  </attributeList>  <reference>http://localhost:9997/notify</reference>  <duration>PT1H</duration>  <notifyConditions>        <notifyCondition>          <type>ONCHANGE</type>          <condValueList>                <condValue>temperature</condValue>                <condValue>lightstatus</condValue>          </condValueList>        </notifyCondition>  </notifyConditions></subscribeContextRequest>'
T@09:37:24  restService[121]: ix 0: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 1: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 2: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 3: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 4: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 5: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 6: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 7: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 8: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 9: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 10: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 11: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 12: component 1 is not a match ('subscribeContext' != 'updateContext')
T@09:37:24  restService[121]: ix 13: component 1 is not a match ('subscribeContext' != 'updateContext')
T@09:37:24  restService[121]: ix 14: component 1 is not a match ('subscribeContext' != 'queryContext')
T@09:37:24  restService[121]: ix 15: component 1 is not a match ('subscribeContext' != 'queryContext')
T@09:37:24  restService[133]: Parsing payload for URL '/NGSI10/subscribeContext', method 'POST', service vector index: 16
T@09:37:24  payloadParse[51]: parsing data for service 'SubscribeContextRequest'. Method: 'POST'
T@09:37:24  payloadParse[52]: outFormat: XML
T@09:37:24  payloadParse[56]: Calling xmlTreat for service request 12, payloadWord 'subscribeContextRequest'
T@09:37:24  nullTreat[99]: Not treating node 'subscribeContextRequest'
T@09:37:24  nullTreat[99]: Not treating node 'entityIdList'
T@09:37:24  entityId[51]: Got an entityId
T@09:37:24  entityIdParse[116]: Got a type for an entity: 'Room'
T@09:37:24  entityIdParse[121]: Got an isPattern for an entity: 'false'
T@09:37:24  entityIdId[75]: Got an entityId:id: 'OfficeRoom4'
T@09:37:24  nullTreat[99]: Not treating node 'attributeList'
T@09:37:24  attribute[88]: Got an attribute
T@09:37:24  attribute[88]: Got an attribute
T@09:37:24  reference[172]: Got a reference: 'http://localhost:9997/notify'
T@09:37:24  duration[185]: Got a duration: 'PT1H'
T@09:37:24  nullTreat[99]: Not treating node 'notifyConditions'
T@09:37:24  notifyCondition[197]: Got a Notify Condition
T@09:37:24  notifyConditionType[225]: Got a Notify Condition Type: 'ONCHANGE'
T@09:37:24  nullTreat[99]: Not treating node 'condValueList'
T@09:37:24  condValue[238]: Got a Cond Value: 'temperature'
T@09:37:24  condValue[238]: Got a Cond Value: 'lightstatus'
T@09:37:24  check[45]: In Restriction::check
T@09:37:24  check[48]: Restriction::check returns OK (counter == 0)
T@09:37:24  ~SubscribeContextResponse[38]: destroyed
T@09:37:24  payloadParse[67]: result: 'OK'
T@09:37:24  payloadParse[68]: outFormat: XML
T@09:37:24  restService[135]: payloadParse returns 'OK'
T@09:37:24  restService[150]: Treating service POST /NGSI10/subscribeContext
T@09:37:24  mongoSubscribeContext[48]: Subscribe Context Request
T@09:37:24  mongoSubscribeContext[59]: Subscription expiration: 1391769444
T@09:37:24  processEntitityPatternFalse[376]: Entity query token (isPattern=false): {id: OfficeRoom4, type: Room}
T@09:37:24  entitiesQuery[455]: Attribute query token: 'temperature'
T@09:37:24  entitiesQuery[455]: Attribute query token: 'lightstatus'
T@09:37:24  entitiesQuery[487]: query() in 'testharness.entities' collection: '{ $or: [ { _id: { $in: [ { id: "OfficeRoom4", type: "Room" } ] } } ], attrs.name: { $in: [ "temperature", "lightstatus" ] } }'
T@09:37:24  mongoSubscribeContext[111]: insert() in 'testharness.csubs' collection: '{ _id: ObjectId('52f4a9544ab2dfa2ff342f88'), expiration: 1391769444, reference: "http://localhost:9997/notify", entities: [ { id: "OfficeRoom4", type: "Room", isPattern: "false" } ], attrs: [ "temperature", "lightstatus" ], conditions: [ { type: "ONCHANGE", value: [ "temperature", "lightstatus" ] } ], format: "XML" }'
T@09:37:24  ~SubscribeContextResponse[38]: destroyed
T@09:37:24  restReply[105]: Response 4: responding with 192 bytes, Status Code 200
T@09:37:24  restReply[106]: Response payload: '<subscribeContextResponse>
  <subscribeResponse>
    <subscriptionId>52f4a9544ab2dfa2ff342f88</subscriptionId>
    <duration>PT1H</duration>
  </subscribeResponse>
</subscribeContextResponse>
'
T@09:37:24  ~RegisterContextResponse[56]: destroyed
T@09:37:24  requestCompleted[128]: Request Completed. Read 675 bytes of 675
T@09:37:24  connectionTreat[300]: HTTP method: POST, URL: /NGSI10/updateContext, version: HTTP/1.1
T@09:37:24  httpHeaderGet[77]: HTTP Header:   User-Agent: curl/7.26.0
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Host: :::9999
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Accept: */*
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Content-Type: application/xml
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Content-Length: 730
T@09:37:24  connectionTreat[278]: Request 5, callNo == 2: 730 bytes of payload (of 730)
T@09:37:24  connectionTreat[373]: method: POST
T@09:37:24  connectionTreat[398]: Not post-processing 730 bytes of data - setting upload_data_size to ZERO?
T@09:37:24  connectionTreat[278]: Request 5, callNo == 3: 0 bytes of payload (of 730)
T@09:37:24  connectionTreat[373]: method: POST
T@09:37:24  connectionTreat[426]: Calling restService '/NGSI10/updateContext' with payload: '<?xml version="1.0"?><updateContextRequest>  <contextElementList>        <contextElement>          <entityId type="Room" isPattern="false">                <id>OfficeRoom6</id>          </entityId>          <contextAttributeList>            <contextAttribute>          <name>pressure</name>                  <type>clima</type>                  <contextValue>p2300</contextValue>                </contextAttribute>            <contextAttribute>          <name>lightstatus</name>                  <type>light</type>                  <contextValue>L23</contextValue>                </contextAttribute>      </contextAttributeList>    </contextElement>  </contextElementList>  <updateAction>APPEND</updateAction></updateContextRequest>'
T@09:37:24  restService[121]: ix 0: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 1: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 2: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 3: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 4: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 5: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 6: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 7: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 8: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 9: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 10: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 11: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[133]: Parsing payload for URL '/NGSI10/updateContext', method 'POST', service vector index: 12
T@09:37:24  payloadParse[51]: parsing data for service 'UpdateContextRequest'. Method: 'POST'
T@09:37:24  payloadParse[52]: outFormat: XML
T@09:37:24  payloadParse[56]: Calling xmlTreat for service request 17, payloadWord 'updateContextRequest'
T@09:37:24  nullTreat[99]: Not treating node 'updateContextRequest'
T@09:37:24  nullTreat[99]: Not treating node 'contextElementList'
T@09:37:24  entityId[67]: Got an entityId
T@09:37:24  entityIdParse[116]: Got a type for an entity: 'Room'
T@09:37:24  entityIdParse[121]: Got an isPattern for an entity: 'false'
T@09:37:24  entityIdId[88]: Got an entityId:id: 'OfficeRoom6'
T@09:37:24  nullTreat[99]: Not treating node 'contextAttributeList'
T@09:37:24  contextAttribute[103]: Creating an attribute
T@09:37:24  contextAttributeName[117]: Got an attribute name: 'pressure'
T@09:37:24  contextAttributeType[130]: Got an attribute type: 'clima'
T@09:37:24  contextAttributeValue[143]: Got an attribute value: 'p2300'
T@09:37:24  contextAttribute[103]: Creating an attribute
T@09:37:24  contextAttributeName[117]: Got an attribute name: 'lightstatus'
T@09:37:24  contextAttributeType[130]: Got an attribute type: 'light'
T@09:37:24  contextAttributeValue[143]: Got an attribute value: 'L23'
T@09:37:24  updateAction[262]: Got an update action: 'APPEND'
T@09:37:24  ~UpdateContextResponse[58]: destroyed
T@09:37:24  payloadParse[67]: result: 'OK'
T@09:37:24  payloadParse[68]: outFormat: XML
T@09:37:24  restService[135]: payloadParse returns 'OK'
T@09:37:24  restService[150]: Treating service POST /NGSI10/updateContext
T@09:37:24  processContextElement[758]: query() in 'testharness.entities' collection: '{ _id.id: "OfficeRoom6", _id.type: "Room" }'
T@09:37:24  createEntity[652]: Entity not found in 'testharness.entities' collection, creating it
T@09:37:24  createEntity[675]: new attribute: {name: pressure, type: clima, value: p2300}
T@09:37:24  createEntity[675]: new attribute: {name: lightstatus, type: light, value: L23}
T@09:37:24  createEntity[696]: insert() in 'testharness.entities' collection: '{ _id: { id: "OfficeRoom6", type: "Room" }, attrs: [ { name: "pressure", type: "clima", value: "p2300", creDate: 1391765844, modDate: 1391765844 }, { name: "lightstatus", type: "light", value: "L23", creDate: 1391765844, modDate: 1391765844 } ], creDate: 1391765844, modDate: 1391765844 }'
T@09:37:24  addTriggeredSubscriptions[371]: JS function: function(){for (var i=0; i < this.entities.length; i++) {if (this.entities[i].isPattern == "true" && (this.entities[i].type == "Room" || this.entities[i].type == "" || !("type" in this.entities[i])) && "OfficeRoom6".match(this.entities[i].id)) {return true; }}return false; }
T@09:37:24  addTriggeredSubscriptions[386]: query() in 'testharness.csubs' collection: '{ $or: [ { entities.id: "OfficeRoom6", $or: [ { entities.type: "Room" }, { entities.type: { $exists: false } } ], entities.isPattern: "false", conditions.type: "ONCHANGE", conditions.value: "pressure", expiration: { $gt: 1391765844 } }, { entities.isPattern: "true", conditions.type: "ONCHANGE", conditions.value: "pressure", expiration: { $gt: 1391765844 }, $where: function(){for (var i=0; i < this.entities.length; i++) {if (this.enti... } ] }'
T@09:37:24  addTriggeredSubscriptions[371]: JS function: function(){for (var i=0; i < this.entities.length; i++) {if (this.entities[i].isPattern == "true" && (this.entities[i].type == "Room" || this.entities[i].type == "" || !("type" in this.entities[i])) && "OfficeRoom6".match(this.entities[i].id)) {return true; }}return false; }
T@09:37:24  addTriggeredSubscriptions[386]: query() in 'testharness.csubs' collection: '{ $or: [ { entities.id: "OfficeRoom6", $or: [ { entities.type: "Room" }, { entities.type: { $exists: false } } ], entities.isPattern: "false", conditions.type: "ONCHANGE", conditions.value: "lightstatus", expiration: { $gt: 1391765844 } }, { entities.isPattern: "true", conditions.type: "ONCHANGE", conditions.value: "lightstatus", expiration: { $gt: 1391765844 }, $where: function(){for (var i=0; i < this.entities.length; i++) {if (this.enti... } ] }'
T@09:37:24  addTriggeredSubscriptions[409]: adding subscription: '{ _id: ObjectId('52f4a9544ab2dfa2ff342f87'), expiration: 1391769444, reference: "http://:::9977/notify", entities: [ { id: "OfficeRoom6", type: "Room", isPattern: "false" } ], attrs: [ "temperature", "lightstatus" ], conditions: [ { type: "ONCHANGE", value: [ "temperature", "lightstatus" ] } ], format: "XML" }'
T@09:37:24  processSubscriptions[437]: retrieved document: '{ _id: ObjectId('52f4a9544ab2dfa2ff342f87'), expiration: 1391769444, reference: "http://:::9977/notify", entities: [ { id: "OfficeRoom6", type: "Room", isPattern: "false" } ], attrs: [ "temperature", "lightstatus" ], conditions: [ { type: "ONCHANGE", value: [ "temperature", "lightstatus" ] } ], format: "XML" }'
T@09:37:24  processEntitityPatternFalse[376]: Entity query token (isPattern=false): {id: OfficeRoom6, type: Room}
T@09:37:24  entitiesQuery[455]: Attribute query token: 'temperature'
T@09:37:24  entitiesQuery[455]: Attribute query token: 'lightstatus'
T@09:37:24  entitiesQuery[487]: query() in 'testharness.entities' collection: '{ $or: [ { _id: { $in: [ { id: "OfficeRoom6", type: "Room" } ] } } ], attrs.name: { $in: [ "temperature", "lightstatus" ] } }'
T@09:37:24  entitiesQuery[509]: retrieved document: '{ _id: { id: "OfficeRoom6", type: "Room" }, attrs: [ { name: "pressure", type: "clima", value: "p2300", creDate: 1391765844, modDate: 1391765844 }, { name: "lightstatus", type: "light", value: "L23", creDate: 1391765844, modDate: 1391765844 } ], creDate: 1391765844, modDate: 1391765844 }'
T@09:37:24  startSenderThread[42]: sending to: host='::', port=9977, verb=POST, path='/notify', content-type: application/xml
T@09:37:24  processSubscriptions[471]: update() in 'testharness.csubs' collection: {{ _id: ObjectId('52f4a9544ab2dfa2ff342f87') }, { $set: { lastNotification: 1391765844 }, $inc: { count: 1 } }}
T@09:37:24  ~UpdateContextResponse[58]: destroyed
T@09:37:24  sendHttpSocket[198]: Sending to HTTP server: sending static message of 897 bytes to HTTP server
T@09:37:24  restReply[105]: Response 5: responding with 806 bytes, Status Code 200
T@09:37:24  sendHttpSocket[199]: Sending to HTTP server payload:
POST /notify HTTP/1.1
User-Agent: orion/0.9.1-next
Host: :::9977
Accept: application/xml, application/json
Content-Type: application/xml
Content-Length: 739

<notifyContextRequest>
  <subscriptionId>52f4a9544ab2dfa2ff342f87</subscriptionId>
  <originator>localhost</originator>
  <contextResponseList>
    <contextElementResponse>
      <contextElement>
        <entityId type="Room" isPattern="false">
          <id>OfficeRoom6</id>
        </entityId>
        <contextAttributeList>
          <contextAttribute>
            <name>lightstatus</name>
            <type>light</type>
            <contextValue>L23</contextValue>
          </contextAttribute>
        </contextAttributeList>
      </contextElement>
      <statusCode>
        <code>200</code>
        <reasonPhrase>OK</reasonPhrase>
      </statusCode>
    </contextElementResponse>
  </contextResponseList>
</notifyContextRequest>


T@09:37:24  restReply[106]: Response payload: '<updateContextResponse>
  <contextResponseList>
    <contextElementResponse>
      <contextElement>
        <entityId type="Room" isPattern="false">
          <id>OfficeRoom6</id>
        </entityId>
        <contextAttributeList>
          <contextAttribute>
            <name>pressure</name>
            <type>clima</type>
            <contextValue></contextValue>
          </contextAttribute>
          <contextAttribute>
            <name>lightstatus</name>
            <type>light</type>
            <contextValue></contextValue>
          </contextAttribute>
        </contextAttributeList>
      </contextElement>
      <statusCode>
        <code>200</code>
        <reasonPhrase>OK</reasonPhrase>
      </statusCode>
    </contextElementResponse>
  </contextResponseList>
</updateContextResponse>
'
T@09:37:24  ~RegisterContextResponse[56]: destroyed
T@09:37:24  requestCompleted[128]: Request Completed. Read 730 bytes of 730
T@09:37:24  sendHttpSocket[227]: not waiting for response
T@09:37:24  connectionTreat[300]: HTTP method: POST, URL: /NGSI10/updateContext, version: HTTP/1.1
T@09:37:24  httpHeaderGet[77]: HTTP Header:   User-Agent: curl/7.26.0
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Host: localhost:9999
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Accept: */*
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Content-Type: application/xml
T@09:37:24  httpHeaderGet[77]: HTTP Header:   Content-Length: 730
T@09:37:24  connectionTreat[278]: Request 6, callNo == 2: 730 bytes of payload (of 730)
T@09:37:24  connectionTreat[373]: method: POST
T@09:37:24  connectionTreat[398]: Not post-processing 730 bytes of data - setting upload_data_size to ZERO?
T@09:37:24  connectionTreat[278]: Request 6, callNo == 3: 0 bytes of payload (of 730)
T@09:37:24  connectionTreat[373]: method: POST
T@09:37:24  connectionTreat[426]: Calling restService '/NGSI10/updateContext' with payload: '<?xml version="1.0"?><updateContextRequest>  <contextElementList>        <contextElement>          <entityId type="Room" isPattern="false">                <id>OfficeRoom4</id>          </entityId>          <contextAttributeList>            <contextAttribute>          <name>pressure</name>                  <type>clima</type>                  <contextValue>p2300</contextValue>                </contextAttribute>            <contextAttribute>          <name>lightstatus</name>                  <type>light</type>                  <contextValue>L23</contextValue>                </contextAttribute>      </contextAttributeList>    </contextElement>  </contextElementList>  <updateAction>APPEND</updateAction></updateContextRequest>'
T@09:37:24  restService[121]: ix 0: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 1: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 2: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 3: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 4: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 5: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 6: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 7: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 8: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 9: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 10: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[121]: ix 11: component 0 is not a match ('NGSI10' != 'ngsi9')
T@09:37:24  restService[133]: Parsing payload for URL '/NGSI10/updateContext', method 'POST', service vector index: 12
T@09:37:24  payloadParse[51]: parsing data for service 'UpdateContextRequest'. Method: 'POST'
T@09:37:24  payloadParse[52]: outFormat: XML
T@09:37:24  payloadParse[56]: Calling xmlTreat for service request 17, payloadWord 'updateContextRequest'
T@09:37:24  nullTreat[99]: Not treating node 'updateContextRequest'
T@09:37:24  nullTreat[99]: Not treating node 'contextElementList'
T@09:37:24  entityId[67]: Got an entityId
T@09:37:24  entityIdParse[116]: Got a type for an entity: 'Room'
T@09:37:24  entityIdParse[121]: Got an isPattern for an entity: 'false'
T@09:37:24  entityIdId[88]: Got an entityId:id: 'OfficeRoom4'
T@09:37:24  nullTreat[99]: Not treating node 'contextAttributeList'
T@09:37:24  contextAttribute[103]: Creating an attribute
T@09:37:24  contextAttributeName[117]: Got an attribute name: 'pressure'
T@09:37:24  contextAttributeType[130]: Got an attribute type: 'clima'
T@09:37:24  contextAttributeValue[143]: Got an attribute value: 'p2300'
T@09:37:24  contextAttribute[103]: Creating an attribute
T@09:37:24  contextAttributeName[117]: Got an attribute name: 'lightstatus'
T@09:37:24  contextAttributeType[130]: Got an attribute type: 'light'
T@09:37:24  contextAttributeValue[143]: Got an attribute value: 'L23'
T@09:37:24  updateAction[262]: Got an update action: 'APPEND'
T@09:37:24  ~UpdateContextResponse[58]: destroyed
T@09:37:24  payloadParse[67]: result: 'OK'
T@09:37:24  payloadParse[68]: outFormat: XML
T@09:37:24  restService[135]: payloadParse returns 'OK'
T@09:37:24  restService[150]: Treating service POST /NGSI10/updateContext
T@09:37:24  processContextElement[758]: query() in 'testharness.entities' collection: '{ _id.id: "OfficeRoom4", _id.type: "Room" }'
T@09:37:24  createEntity[652]: Entity not found in 'testharness.entities' collection, creating it
T@09:37:24  createEntity[675]: new attribute: {name: pressure, type: clima, value: p2300}
T@09:37:24  createEntity[675]: new attribute: {name: lightstatus, type: light, value: L23}
T@09:37:24  createEntity[696]: insert() in 'testharness.entities' collection: '{ _id: { id: "OfficeRoom4", type: "Room" }, attrs: [ { name: "pressure", type: "clima", value: "p2300", creDate: 1391765844, modDate: 1391765844 }, { name: "lightstatus", type: "light", value: "L23", creDate: 1391765844, modDate: 1391765844 } ], creDate: 1391765844, modDate: 1391765844 }'
T@09:37:24  addTriggeredSubscriptions[371]: JS function: function(){for (var i=0; i < this.entities.length; i++) {if (this.entities[i].isPattern == "true" && (this.entities[i].type == "Room" || this.entities[i].type == "" || !("type" in this.entities[i])) && "OfficeRoom4".match(this.entities[i].id)) {return true; }}return false; }
T@09:37:24  addTriggeredSubscriptions[386]: query() in 'testharness.csubs' collection: '{ $or: [ { entities.id: "OfficeRoom4", $or: [ { entities.type: "Room" }, { entities.type: { $exists: false } } ], entities.isPattern: "false", conditions.type: "ONCHANGE", conditions.value: "pressure", expiration: { $gt: 1391765844 } }, { entities.isPattern: "true", conditions.type: "ONCHANGE", conditions.value: "pressure", expiration: { $gt: 1391765844 }, $where: function(){for (var i=0; i < this.entities.length; i++) {if (this.enti... } ] }'
T@09:37:24  addTriggeredSubscriptions[371]: JS function: function(){for (var i=0; i < this.entities.length; i++) {if (this.entities[i].isPattern == "true" && (this.entities[i].type == "Room" || this.entities[i].type == "" || !("type" in this.entities[i])) && "OfficeRoom4".match(this.entities[i].id)) {return true; }}return false; }
T@09:37:24  addTriggeredSubscriptions[386]: query() in 'testharness.csubs' collection: '{ $or: [ { entities.id: "OfficeRoom4", $or: [ { entities.type: "Room" }, { entities.type: { $exists: false } } ], entities.isPattern: "false", conditions.type: "ONCHANGE", conditions.value: "lightstatus", expiration: { $gt: 1391765844 } }, { entities.isPattern: "true", conditions.type: "ONCHANGE", conditions.value: "lightstatus", expiration: { $gt: 1391765844 }, $where: function(){for (var i=0; i < this.entities.length; i++) {if (this.enti... } ] }'
T@09:37:24  addTriggeredSubscriptions[409]: adding subscription: '{ _id: ObjectId('52f4a9544ab2dfa2ff342f88'), expiration: 1391769444, reference: "http://localhost:9997/notify", entities: [ { id: "OfficeRoom4", type: "Room", isPattern: "false" } ], attrs: [ "temperature", "lightstatus" ], conditions: [ { type: "ONCHANGE", value: [ "temperature", "lightstatus" ] } ], format: "XML" }'
T@09:37:24  processSubscriptions[437]: retrieved document: '{ _id: ObjectId('52f4a9544ab2dfa2ff342f88'), expiration: 1391769444, reference: "http://localhost:9997/notify", entities: [ { id: "OfficeRoom4", type: "Room", isPattern: "false" } ], attrs: [ "temperature", "lightstatus" ], conditions: [ { type: "ONCHANGE", value: [ "temperature", "lightstatus" ] } ], format: "XML" }'
T@09:37:24  processEntitityPatternFalse[376]: Entity query token (isPattern=false): {id: OfficeRoom4, type: Room}
T@09:37:24  entitiesQuery[455]: Attribute query token: 'temperature'
T@09:37:24  entitiesQuery[455]: Attribute query token: 'lightstatus'
T@09:37:24  entitiesQuery[487]: query() in 'testharness.entities' collection: '{ $or: [ { _id: { $in: [ { id: "OfficeRoom4", type: "Room" } ] } } ], attrs.name: { $in: [ "temperature", "lightstatus" ] } }'
T@09:37:24  entitiesQuery[509]: retrieved document: '{ _id: { id: "OfficeRoom4", type: "Room" }, attrs: [ { name: "pressure", type: "clima", value: "p2300", creDate: 1391765844, modDate: 1391765844 }, { name: "lightstatus", type: "light", value: "L23", creDate: 1391765844, modDate: 1391765844 } ], creDate: 1391765844, modDate: 1391765844 }'
T@09:37:24  startSenderThread[42]: sending to: host='localhost', port=9997, verb=POST, path='/notify', content-type: application/xml
T@09:37:24  processSubscriptions[471]: update() in 'testharness.csubs' collection: {{ _id: ObjectId('52f4a9544ab2dfa2ff342f88') }, { $set: { lastNotification: 1391765844 }, $inc: { count: 1 } }}
T@09:37:24  ~UpdateContextResponse[58]: destroyed
T@09:37:24  restReply[105]: Response 6: responding with 806 bytes, Status Code 200
T@09:37:24  restReply[106]: Response payload: '<updateContextResponse>
  <contextResponseList>
    <contextElementResponse>
      <contextElement>
        <entityId type="Room" isPattern="false">
          <id>OfficeRoom4</id>
        </entityId>
        <contextAttributeList>
          <contextAttribute>
            <name>pressure</name>
            <type>clima</type>
            <contextValue></contextValue>
          </contextAttribute>
          <contextAttribute>
            <name>lightstatus</name>
            <type>light</type>
            <contextValue></contextValue>
          </contextAttribute>
        </contextAttributeList>
      </contextElement>
      <statusCode>
        <code>200</code>
        <reasonPhrase>OK</reasonPhrase>
      </statusCode>
    </contextElementResponse>
  </contextResponseList>
</updateContextResponse>
'
T@09:37:24  ~RegisterContextResponse[56]: destroyed
T@09:37:24  requestCompleted[128]: Request Completed. Read 730 bytes of 730
E@09:37:24  socketHttpConnect[82]: connect(localhost, 9997): Connection refused
E@09:37:24  sendHttpSocket[193]: Unable to connect to HTTP server at localhost:9997
F@09:37:24  ***[500]: In sigHandler - caught signal 15
X@09:37:24  sigHandler[506]: Received signal 15
1 EntityIds:
  Entity Id 0:
    Id:         OfficeRoom6
    Type:       Room
    isPattern:  false
  Attribute List
    temperature
    lightstatus
  Reference: http://:::9977/notify
  Duration: PT1H
  No AttributeExpression
No scopes
1 NotifyConditions    Notify Condition 0:
    type: ONCHANGE
    ConditionValue List
      temperature
      lightstatus
    No RestrictionString
  No Throttling
1 EntityIds:
  Entity Id 0:
    Id:         OfficeRoom4
    Type:       Room
    isPattern:  false
  Attribute List
    temperature
    lightstatus
  Reference: http://localhost:9997/notify
  Duration: PT1H
  No AttributeExpression
No scopes
1 NotifyConditions    Notify Condition 0:
    type: ONCHANGE
    ConditionValue List
      temperature
      lightstatus
    No RestrictionString
  No Throttling


1 ContextElementsContext Element 0:
  Entity Id:
    Id:         OfficeRoom6
    Type:       Room
    isPattern:  false
  No AttributeDomainName
2 ContextAttributes  Attribute 0:
    Name:       pressure
    Type:       clima
    Value:      p2300
0 Attribute Metadatas
  Attribute 1:
    Name:       lightstatus
    Type:       light
    Value:      L23
0 Attribute Metadatas
0 Domain Metadatas
UpdateActionType: APPEND


1 ContextElementsContext Element 0:
  Entity Id:
    Id:         OfficeRoom4
    Type:       Room
    isPattern:  false
  No AttributeDomainName
2 ContextAttributes  Attribute 0:
    Name:       pressure
    Type:       clima
    Value:      p2300
0 Attribute Metadatas
  Attribute 1:
    Name:       lightstatus
    Type:       light
    Value:      L23
0 Attribute Metadatas
0 Domain Metadatas
UpdateActionType: APPEND
