==29852== Memcheck, a memory error detector
==29852== Copyright (C) 2002-2011, and GNU GPL'd, by Julian Seward et al.
==29852== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==29852== Command: contextBroker -vvvvv -harakiri -port 9999 -pidpath /tmp/orion_9999.pid -db testharness -t 0-255
==29852== 
T@09:30:55  paConfigActions[727]: setting trace levels to '0-255'
T@09:30:55  paConfigActions[728]: Leaving function paConfigActions
E@09:30:55  exitFunc[559]: unlink(/tmp/orion_9999.pid): No such file or directory
T@09:30:55  semInit[61]: Initialized 'req' semaphore
T@09:30:55  semInit[62]: Initialized 'mongo' semaphore
T@09:30:55  mongoSemTake[90]: mongoConnect taking the 'mongo' semaphore for 'connecting to mongo'
T@09:30:55  mongoSemTake[92]: mongoConnect has the 'mongo' semaphore
==29852== 
==29852== HEAP SUMMARY:
==29852==     in use at exit: 17,690 bytes in 104 blocks
==29852==   total heap usage: 3,269 allocs, 3,165 frees, 313,863 bytes allocated
==29852== 
==29852== LEAK SUMMARY:
==29852==    definitely lost: 0 bytes in 0 blocks
==29852==    indirectly lost: 0 bytes in 0 blocks
==29852==      possibly lost: 0 bytes in 0 blocks
==29852==    still reachable: 17,690 bytes in 104 blocks
==29852==         suppressed: 0 bytes in 0 blocks
==29852== Rerun with --leak-check=full to see details of leaked memory
==29852== 
==29852== For counts of detected and suppressed errors, rerun with: -v
==29852== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 7 from 7)
T@09:30:55  mongoConnect[136]: mongo version server: 2.4.9 (mayor: 2, minor: 4, extra: 9)
T@09:30:55  mongoSemGive[118]: mongoConnect gives the 'mongo' semaphore for 'connecting to mongo'
F@09:30:55  ***[600]: Connected to mongo at localhost:testharness
T@09:30:55  ensureLocationIndex[336]: ensuring 2dsphere index on location.coords
T@09:30:55  recoverOntimeIntervalThreads[353]: query() in 'testharness.csubs' collection: '{ conditions.type: "ONTIMEINTERVAL" }'
T@09:30:55  mongoSemTake[90]: recoverOntimeIntervalThreads taking the 'mongo' semaphore for 'query in SubscribeContextCollection'
T@09:30:55  mongoSemTake[92]: recoverOntimeIntervalThreads has the 'mongo' semaphore
T@09:30:56  mongoSemGive[118]: recoverOntimeIntervalThreads gives the 'mongo' semaphore for 'query in SubscribeContextCollection'
==29857== Source and destination overlap in strncpy(0xa4d8a7, 0xa4d8a7, 63)
==29857==    at 0x4C29782: strncpy (mc_replace_strmem.c:463)
==29857==    by 0x659678: restInit(RestService*, IpVersion, char const*, unsigned short, char const*, char const*, void (*)(ConnectionInfo*), bool) (rest.cpp:600)
==29857==    by 0x5DF38D: main (contextBroker.cpp:737)
==29857== 
==29857== Source and destination overlap in strncpy(0xa4d8e2, 0xa4d8e2, 63)
==29857==    at 0x4C29782: strncpy (mc_replace_strmem.c:463)
==29857==    by 0x65969C: restInit(RestService*, IpVersion, char const*, unsigned short, char const*, char const*, void (*)(ConnectionInfo*), bool) (rest.cpp:603)
==29857==    by 0x5DF38D: main (contextBroker.cpp:737)
==29857== 
V@09:30:56  restStart[499]: Starting HTTP daemon on IPv4 0.0.0.0 port 9999
V@09:30:56  restStart[541]: Starting HTTP daemon on IPv6 :: port 9999
==29857== Thread 4:
==29857== Syscall param mmap(length) contains uninitialised byte(s)
==29857==    at 0x58B9AFA: mmap (syscall-template.S:82)
==29857==    by 0x4E398E7: MHD_pool_create (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35F47: MHD_connection_get_pollfd (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35FFB: MHD_connection_get_fdset (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E373B0: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A1F: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E334BF: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35F20: MHD_connection_get_pollfd (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35FFB: MHD_connection_get_fdset (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E373B0: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A24: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E334BF: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35F20: MHD_connection_get_pollfd (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35FFB: MHD_connection_get_fdset (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E373B0: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A52: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E334BF: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35F20: MHD_connection_get_pollfd (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35FFB: MHD_connection_get_fdset (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E373B0: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E399BC: MHD_pool_allocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E33C62: MHD_set_connection_value (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34033: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E3426D: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34783: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
T@09:31:03  httpHeaderGet[94]: HTTP Header:   User-Agent: curl/7.26.0
T@09:31:03  httpHeaderGet[94]: HTTP Header:   Host: localhost:9999
T@09:31:03  httpHeaderGet[94]: HTTP Header:   Accept: */*
T@09:31:03  httpHeaderGet[94]: HTTP Header:   Content-Type: application/xml
T@09:31:03  httpHeaderGet[94]: HTTP Header:   Content-Length: 1060
T@09:31:03  httpHeaderGet[94]: HTTP Header:   Expect: 100-continue
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A1F: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E334BF: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35D17: MHD_connection_handle_read (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37648: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A24: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E334BF: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35D17: MHD_connection_handle_read (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37648: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A52: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E334BF: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35D17: MHD_connection_handle_read (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37648: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
T@09:31:03  restService[135]: Parsing payload for URL '/ngsi10/queryContext', method 'POST', service vector index: 14
T@09:31:03  payloadParse[53]: parsing data for service 'QueryContextRequest'. Method: 'POST'
T@09:31:03  payloadParse[54]: outFormat: XML
T@09:31:03  payloadParse[58]: Calling xmlTreat for service request 11, payloadWord 'queryContextRequest'
2@09:31:03  xmlRequestGet[155]: Found xmlRequest of type 11, method 'POST' - index 14 (/queryContextRequest)
T@09:31:03  nullTreat[272]: Not treating node 'queryContextRequest'
T@09:31:03  nullTreat[272]: Not treating node 'entityIdList'
T@09:31:03  entityId[53]: Got an entityId
T@09:31:03  entityIdParse[291]: Got a type for an entity: 'Room'
T@09:31:03  entityIdParse[296]: Got an isPattern for an entity: 'false'
T@09:31:03  entityIdId[74]: Got an entityId:id: 'entity01'
T@09:31:03  nullTreat[272]: Not treating node 'attributeList'
T@09:31:03  attribute[89]: Got an attribute
T@09:31:03  attribute[89]: Got an attribute
T@09:31:03  attribute[89]: Got an attribute
T@09:31:03  restriction[104]: Got a restriction
T@09:31:03  restriction[106]: Got a restriction - from value 0
T@09:31:03  restriction[108]: Got a restriction - to value 1
T@09:31:03  attributeExpression[121]: Got an attributeExpression: 'Attribute Expression'
T@09:31:03  nullTreat[272]: Not treating node 'scope'
T@09:31:03  operationScope[137]: Got an operationScope
T@09:31:03  scopeType[152]: Got a scopeType: 'st1'
T@09:31:03  scopeValue[180]: Got a scopeValue: 'sv1' for scopeType 'st1'
T@09:31:03  operationScope[137]: Got an operationScope
T@09:31:03  scopeType[152]: Got a scopeType: 'FIWARE_Location'
T@09:31:03  scopeValue[175]: Preparing scopeValue for 'FIWARE_Location'
T@09:31:03  circle[194]: Got a circle
T@09:31:03  circleRadius[234]: Got a circleRadius: 10
T@09:31:03  circleCenterLatitude[207]: Got a circleCenterLatitude: 45
T@09:31:03  circleCenterLongitude[221]: Got a circleCenterLongitude: 45
T@09:31:03  circleInverted[247]: Got a circleInverted: 0
T@09:31:03  operationScope[137]: Got an operationScope
T@09:31:03  scopeType[152]: Got a scopeType: 'st2'
T@09:31:03  scopeValue[180]: Got a scopeValue: 'sv2' for scopeType 'st2'
T@09:31:03  xmlTreat[251]: Calling check for XML parsed tree (queryContextRequest)
T@09:31:03  check[45]: In Restriction::check
T@09:31:03  check[59]: Restriction::check returns OK (2)
T@09:31:03  ~QueryContextResponse[64]: destroyed
T@09:31:03  payloadParse[69]: result: 'OK'
T@09:31:03  payloadParse[70]: outFormat: XML
T@09:31:03  restService[138]: payloadParse returns 'OK'
T@09:31:03  restService[153]: Treating service POST /ngsi10/queryContext
T@09:31:03  reqSemTake[75]: mongoQueryContext taking the 'req' semaphore for 'ngsi10 query request'
T@09:31:03  reqSemTake[77]: mongoQueryContext has the 'req' semaphore
T@09:31:03  mongoQueryContext[47]: QueryContext Request
W@09:31:03  mongoQueryContext[51]: Restriction found but not supported at mongo backend
T@09:31:03  processEntitityPatternFalse[486]: Entity query token (isPattern=false): {id: entity01, type: Room}
T@09:31:03  entitiesQuery[702]: Attribute query token: 'temperature'
T@09:31:03  entitiesQuery[702]: Attribute query token: 'occupancy'
T@09:31:03  entitiesQuery[702]: Attribute query token: 'lightstatus'
E@09:31:03  processAreaScope[636]: unknown area type
T@09:31:03  entitiesQuery[742]: query() in 'testharness.entities' collection: '{ $or: [ { _id: { $in: [ { id: "entity01", type: "Room" } ] } } ], attrs.name: { $in: [ "temperature", "occupancy", "lightstatus" ] } }'
T@09:31:03  mongoSemTake[90]: entitiesQuery taking the 'mongo' semaphore for 'query in EntitiesCollection'
T@09:31:03  mongoSemTake[92]: entitiesQuery has the 'mongo' semaphore
T@09:31:03  mongoSemGive[118]: entitiesQuery gives the 'mongo' semaphore for 'query in EntitiesCollection'
T@09:31:03  reqSemGive[104]: mongoQueryContext gives the 'req' semaphore for 'ngsi10 query request'
T@09:31:03  ~QueryContextResponse[64]: destroyed
T@09:31:03  restReply[65]: Response 1: responding with 155 bytes, Status Code 200
T@09:31:03  restReply[66]: Response payload: '<queryContextResponse>
  <errorCode>
    <code>404</code>
    <reasonPhrase>No context element found</reasonPhrase>
  </errorCode>
</queryContextResponse>
'
T@09:31:03  ~RegisterContextResponse[56]: destroyed
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E399BC: MHD_pool_allocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E335B6: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E335BD: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C2A639: memcpy (mc_replace_strmem.c:121)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C2A64E: memcpy (mc_replace_strmem.c:838)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C2A69B: memcpy (mc_replace_strmem.c:838)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C2A790: memcpy (mc_replace_strmem.c:838)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Use of uninitialised value of size 8
==29857==    at 0x4C2A7C8: memcpy (mc_replace_strmem.c:838)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Use of uninitialised value of size 8
==29857==    at 0x4C2A7ED: memcpy (mc_replace_strmem.c:838)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Use of uninitialised value of size 8
==29857==    at 0x58CFC9C: __vsprintf_chk (vsprintf_chk.c:79)
==29857==    by 0x58CFC0E: __sprintf_chk (sprintf_chk.c:33)
==29857==    by 0x4E33622: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Use of uninitialised value of size 8
==29857==    at 0x4C2953C: strcpy (mc_replace_strmem.c:429)
==29857==    by 0x4E33913: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C29569: strcpy (mc_replace_strmem.c:112)
==29857==    by 0x4E33913: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C2956E: strcpy (mc_replace_strmem.c:121)
==29857==    by 0x4E33913: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C2957F: strcpy (mc_replace_strmem.c:429)
==29857==    by 0x4E33913: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Use of uninitialised value of size 8
==29857==    at 0x4E3363E: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Syscall param sendto(msg) contains uninitialised byte(s)
==29857==    at 0x58BE0AC: send (send.c:32)
==29857==    by 0x4E36D69: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35963: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35A87: MHD_connection_handle_write (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37638: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A1F: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E33BA1: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35A9D: MHD_connection_handle_write (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37638: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A24: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E33BA1: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35A9D: MHD_connection_handle_write (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37638: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4E39A40: MHD_pool_reallocate (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E33BA1: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E35A9D: MHD_connection_handle_write (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37638: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Thread 3:
==29857== Syscall param munmap(length) contains uninitialised byte(s)
==29857==    at 0x58B9B27: munmap (syscall-template.S:82)
==29857==    by 0x4E3996B: MHD_pool_destroy (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37030: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E3881C: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
T@09:31:04  httpHeaderGet[94]: HTTP Header:   User-Agent: curl/7.26.0
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Host: localhost:9999
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Accept: */*
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Content-Type: application/xml
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Content-Length: 687
T@09:31:04  restService[135]: Parsing payload for URL '/ngsi10/updateContext', method 'POST', service vector index: 12
T@09:31:04  payloadParse[53]: parsing data for service 'UpdateContextRequest'. Method: 'POST'
T@09:31:04  payloadParse[54]: outFormat: XML
T@09:31:04  payloadParse[58]: Calling xmlTreat for service request 17, payloadWord 'updateContextRequest'
2@09:31:04  xmlRequestGet[155]: Found xmlRequest of type 17, method 'POST' - index 12 (/updateContextRequest)
T@09:31:04  nullTreat[272]: Not treating node 'updateContextRequest'
T@09:31:04  nullTreat[272]: Not treating node 'contextElementList'
T@09:31:04  entityId[67]: Got an entityId
T@09:31:04  entityIdParse[291]: Got a type for an entity: 'Room'
T@09:31:04  entityIdParse[296]: Got an isPattern for an entity: 'false'
T@09:31:04  entityIdId[88]: Got an entityId:id: 'entity01'
T@09:31:04  nullTreat[272]: Not treating node 'contextAttributeList'
T@09:31:04  contextAttribute[103]: Creating an attribute
T@09:31:04  ContextAttribute[42]: Creating a ContextAttribute 1
T@09:31:04  contextAttributeName[117]: Got an attribute name: 'temperature'
T@09:31:04  contextAttributeType[130]: Got an attribute type: 'degree'
T@09:31:04  contextAttributeValue[147]: Set parseDataP->lastContextAttribute (type: '') to: 0x72b1990
T@09:31:04  contextAttributeValue[149]: Got an attribute value: '11'
T@09:31:04  contextAttribute[103]: Creating an attribute
T@09:31:04  ContextAttribute[42]: Creating a ContextAttribute 1
T@09:31:04  contextAttributeName[117]: Got an attribute name: 'lightstatus'
T@09:31:04  contextAttributeType[130]: Got an attribute type: 'light'
T@09:31:04  contextAttributeValue[147]: Set parseDataP->lastContextAttribute (type: '') to: 0x72e2b10
T@09:31:04  contextAttributeValue[149]: Got an attribute value: 'L23'
T@09:31:04  updateAction[272]: Got an update action: 'APPEND'
T@09:31:04  xmlTreat[251]: Calling check for XML parsed tree (updateContextRequest)
T@09:31:04  ~UpdateContextResponse[58]: destroyed
T@09:31:04  payloadParse[69]: result: 'OK'
T@09:31:04  payloadParse[70]: outFormat: XML
T@09:31:04  restService[138]: payloadParse returns 'OK'
T@09:31:04  restService[153]: Treating service POST /ngsi10/updateContext
T@09:31:04  reqSemTake[75]: mongoUpdateContext taking the 'req' semaphore for 'ngsi10 update request'
T@09:31:04  reqSemTake[77]: mongoUpdateContext has the 'req' semaphore
T@09:31:04  processContextElement[1399]: query() in 'testharness.entities' collection: '{ _id.id: "entity01", _id.type: "Room" }'
T@09:31:04  mongoSemTake[90]: processContextElement taking the 'mongo' semaphore for 'query in EntitiesCollection'
T@09:31:04  mongoSemTake[92]: processContextElement has the 'mongo' semaphore
T@09:31:04  mongoSemGive[118]: processContextElement gives the 'mongo' semaphore for 'query in EntitiesCollection'
T@09:31:04  ContextAttribute[86]: Creating a ContextAttribute 'temperature':'degree':'', setting its compound to NULL
T@09:31:04  ContextAttribute[86]: Creating a ContextAttribute 'lightstatus':'light':'', setting its compound to NULL
T@09:31:04  createEntity[1209]: Entity not found in 'testharness.entities' collection, creating it
T@09:31:04  createEntity[1241]: new attribute: {name: temperature, type: degree, value: 11}
==29857== Thread 4:
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x63FD37: contextAttributeCustomMetadataToBson(mongo::BSONObj&, ContextAttribute*) (MongoCommonUpdate.cpp:536)
==29857==    by 0x649675: createEntity(EntityId, ContextAttributeVector, std::string*) (MongoCommonUpdate.cpp:1254)
==29857==    by 0x64D4B3: processContextElement(ContextElement*, UpdateContextResponse*, std::string) (MongoCommonUpdate.cpp:1594)
==29857==    by 0x633A5B: mongoUpdateContext(UpdateContextRequest*, UpdateContextResponse*) (mongoUpdateContext.cpp:51)
==29857==    by 0x615FBC: postUpdateContext(ConnectionInfo*, int, std::vector<std::string, std::allocator<std::string> >, ParseData*) (postUpdateContext.cpp:44)
==29857==    by 0x65D126: restService(ConnectionInfo*, RestService*) (RestService.cpp:155)
==29857==    by 0x6577FC: serve(ConnectionInfo*) (rest.cpp:234)
==29857==    by 0x658AA1: connectionTreat(void*, MHD_Connection*, char const*, char const*, char const*, char const*, unsigned long*, void**) (rest.cpp:458)
==29857==    by 0x4E34328: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DBF: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857== 
T@09:31:04  createEntity[1241]: new attribute: {name: lightstatus, type: light, value: L23}
T@09:31:04  createEntity[1276]: insert() in 'testharness.entities' collection: '{ _id: { id: "entity01", type: "Room" }, attrs: [ { name: "temperature", type: "degree", creDate: 1399455064, modDate: 1399455064, value: "11" }, { name: "lightstatus", type: "light", creDate: 1399455064, modDate: 1399455064, value: "L23" } ], creDate: 1399455064, modDate: 1399455064 }'
T@09:31:04  mongoSemTake[90]: createEntity taking the 'mongo' semaphore for 'insert into EntitiesCollection'
T@09:31:04  mongoSemTake[92]: createEntity has the 'mongo' semaphore
T@09:31:04  mongoSemGive[118]: createEntity gives the 'mongo' semaphore for 'insert into EntitiesCollection'
T@09:31:04  addTriggeredSubscriptions[782]: JS function: function(){for (var i=0; i < this.entities.length; i++) {if (this.entities[i].isPattern == "true" && (this.entities[i].type == "Room" || this.entities[i].type == "" || !("type" in this.entities[i])) && "entity01".match(this.entities[i].id)) {return true; }}return false; }
T@09:31:04  addTriggeredSubscriptions[797]: query() in 'testharness.csubs' collection: '{ $or: [ { entities.id: "entity01", $or: [ { entities.type: "Room" }, { entities.type: { $exists: false } } ], entities.isPattern: "false", conditions.type: "ONCHANGE", conditions.value: "temperature", expiration: { $gt: 1399455064 } }, { entities.isPattern: "true", conditions.type: "ONCHANGE", conditions.value: "temperature", expiration: { $gt: 1399455064 }, $where: function(){for (var i=0; i < this.entities.length; i++) {if (this.enti... } ] }'
T@09:31:04  mongoSemTake[90]: addTriggeredSubscriptions taking the 'mongo' semaphore for 'query in SubscribeContextCollection'
T@09:31:04  mongoSemTake[92]: addTriggeredSubscriptions has the 'mongo' semaphore
T@09:31:04  mongoSemGive[118]: addTriggeredSubscriptions gives the 'mongo' semaphore for 'query in SubscribeContextCollection'
T@09:31:04  addTriggeredSubscriptions[782]: JS function: function(){for (var i=0; i < this.entities.length; i++) {if (this.entities[i].isPattern == "true" && (this.entities[i].type == "Room" || this.entities[i].type == "" || !("type" in this.entities[i])) && "entity01".match(this.entities[i].id)) {return true; }}return false; }
T@09:31:04  addTriggeredSubscriptions[797]: query() in 'testharness.csubs' collection: '{ $or: [ { entities.id: "entity01", $or: [ { entities.type: "Room" }, { entities.type: { $exists: false } } ], entities.isPattern: "false", conditions.type: "ONCHANGE", conditions.value: "lightstatus", expiration: { $gt: 1399455064 } }, { entities.isPattern: "true", conditions.type: "ONCHANGE", conditions.value: "lightstatus", expiration: { $gt: 1399455064 }, $where: function(){for (var i=0; i < this.entities.length; i++) {if (this.enti... } ] }'
T@09:31:04  mongoSemTake[90]: addTriggeredSubscriptions taking the 'mongo' semaphore for 'query in SubscribeContextCollection'
T@09:31:04  mongoSemTake[92]: addTriggeredSubscriptions has the 'mongo' semaphore
T@09:31:04  mongoSemGive[118]: addTriggeredSubscriptions gives the 'mongo' semaphore for 'query in SubscribeContextCollection'
T@09:31:04  reqSemGive[104]: mongoUpdateContext gives the 'req' semaphore for 'ngsi10 update request'
T@09:31:04  ~UpdateContextResponse[58]: destroyed
T@09:31:04  restReply[65]: Response 2: responding with 807 bytes, Status Code 200
T@09:31:04  restReply[66]: Response payload: '<updateContextResponse>
  <contextResponseList>
    <contextElementResponse>
      <contextElement>
        <entityId type="Room" isPattern="false">
          <id>entity01</id>
        </entityId>
        <contextAttributeList>
          <contextAttribute>
            <name>temperature</name>
            <type>degree</type>
            <contextValue></contextValue>
          </contextAttribute>
          <contextAttribute>
            <name>lightstatus</name>
            <type>light</type>
            <contextValue></contextValue>
          </contextAttribute>
        </contextAttributeList>
      </contextElement>
      <statusCode>
        <code>200</code>
        <reasonPhrase>OK</reasonPhrase>
      </statusCode>
    </contextElementResponse>
  </contextResponseList>
</updateContextResponse>
'
T@09:31:04  ~RegisterContextResponse[56]: destroyed
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C2A63F: memcpy (mc_replace_strmem.c:124)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Use of uninitialised value of size 8
==29857==    at 0x4C2A6FB: memcpy (mc_replace_strmem.c:838)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Use of uninitialised value of size 8
==29857==    at 0x4C2A763: memcpy (mc_replace_strmem.c:838)
==29857==    by 0x4E338FA: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
==29857== Conditional jump or move depends on uninitialised value(s)
==29857==    at 0x4C29570: strcpy (mc_replace_strmem.c:124)
==29857==    by 0x4E33913: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E34DE0: MHD_connection_handle_idle (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x4E37420: ??? (in /usr/lib/x86_64-linux-gnu/libmicrohttpd.so.10.15.0)
==29857==    by 0x5B72B4F: start_thread (pthread_create.c:304)
==29857==    by 0x58BD0EC: clone (clone.S:112)
==29857== 
T@09:31:04  httpHeaderGet[94]: HTTP Header:   User-Agent: curl/7.26.0
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Host: localhost:9999
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Accept: */*
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Content-Type: application/xml
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Content-Length: 1060
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Expect: 100-continue
T@09:31:04  restService[135]: Parsing payload for URL '/ngsi10/queryContext', method 'POST', service vector index: 14
T@09:31:04  payloadParse[53]: parsing data for service 'QueryContextRequest'. Method: 'POST'
T@09:31:04  payloadParse[54]: outFormat: XML
T@09:31:04  payloadParse[58]: Calling xmlTreat for service request 11, payloadWord 'queryContextRequest'
2@09:31:04  xmlRequestGet[155]: Found xmlRequest of type 11, method 'POST' - index 14 (/queryContextRequest)
T@09:31:04  nullTreat[272]: Not treating node 'queryContextRequest'
T@09:31:04  nullTreat[272]: Not treating node 'entityIdList'
T@09:31:04  entityId[53]: Got an entityId
T@09:31:04  entityIdParse[291]: Got a type for an entity: 'Room'
T@09:31:04  entityIdParse[296]: Got an isPattern for an entity: 'false'
T@09:31:04  entityIdId[74]: Got an entityId:id: 'entity01'
T@09:31:04  nullTreat[272]: Not treating node 'attributeList'
T@09:31:04  attribute[89]: Got an attribute
T@09:31:04  attribute[89]: Got an attribute
T@09:31:04  attribute[89]: Got an attribute
T@09:31:04  restriction[104]: Got a restriction
T@09:31:04  restriction[106]: Got a restriction - from value 0
T@09:31:04  restriction[108]: Got a restriction - to value 1
T@09:31:04  attributeExpression[121]: Got an attributeExpression: 'Attribute Expression'
T@09:31:04  nullTreat[272]: Not treating node 'scope'
T@09:31:04  operationScope[137]: Got an operationScope
T@09:31:04  scopeType[152]: Got a scopeType: 'st1'
T@09:31:04  scopeValue[180]: Got a scopeValue: 'sv1' for scopeType 'st1'
T@09:31:04  operationScope[137]: Got an operationScope
T@09:31:04  scopeType[152]: Got a scopeType: 'FIWARE_Location'
T@09:31:04  scopeValue[175]: Preparing scopeValue for 'FIWARE_Location'
T@09:31:04  circle[194]: Got a circle
T@09:31:04  circleRadius[234]: Got a circleRadius: 10
T@09:31:04  circleCenterLatitude[207]: Got a circleCenterLatitude: 45
T@09:31:04  circleCenterLongitude[221]: Got a circleCenterLongitude: 45
T@09:31:04  circleInverted[247]: Got a circleInverted: 0
T@09:31:04  operationScope[137]: Got an operationScope
T@09:31:04  scopeType[152]: Got a scopeType: 'st2'
T@09:31:04  scopeValue[180]: Got a scopeValue: 'sv2' for scopeType 'st2'
T@09:31:04  xmlTreat[251]: Calling check for XML parsed tree (queryContextRequest)
T@09:31:04  check[45]: In Restriction::check
T@09:31:04  check[59]: Restriction::check returns OK (2)
T@09:31:04  ~QueryContextResponse[64]: destroyed
T@09:31:04  payloadParse[69]: result: 'OK'
T@09:31:04  payloadParse[70]: outFormat: XML
T@09:31:04  restService[138]: payloadParse returns 'OK'
T@09:31:04  restService[153]: Treating service POST /ngsi10/queryContext
T@09:31:04  reqSemTake[75]: mongoQueryContext taking the 'req' semaphore for 'ngsi10 query request'
T@09:31:04  reqSemTake[77]: mongoQueryContext has the 'req' semaphore
T@09:31:04  mongoQueryContext[47]: QueryContext Request
W@09:31:04  mongoQueryContext[51]: Restriction found but not supported at mongo backend
T@09:31:04  processEntitityPatternFalse[486]: Entity query token (isPattern=false): {id: entity01, type: Room}
T@09:31:04  entitiesQuery[702]: Attribute query token: 'temperature'
T@09:31:04  entitiesQuery[702]: Attribute query token: 'occupancy'
T@09:31:04  entitiesQuery[702]: Attribute query token: 'lightstatus'
E@09:31:04  processAreaScope[636]: unknown area type
T@09:31:04  entitiesQuery[742]: query() in 'testharness.entities' collection: '{ $or: [ { _id: { $in: [ { id: "entity01", type: "Room" } ] } } ], attrs.name: { $in: [ "temperature", "occupancy", "lightstatus" ] } }'
T@09:31:04  mongoSemTake[90]: entitiesQuery taking the 'mongo' semaphore for 'query in EntitiesCollection'
T@09:31:04  mongoSemTake[92]: entitiesQuery has the 'mongo' semaphore
T@09:31:04  mongoSemGive[118]: entitiesQuery gives the 'mongo' semaphore for 'query in EntitiesCollection'
T@09:31:04  entitiesQuery[779]: retrieved document: '{ _id: { id: "entity01", type: "Room" }, attrs: [ { name: "temperature", type: "degree", creDate: 1399455064, modDate: 1399455064, value: "11" }, { name: "lightstatus", type: "light", creDate: 1399455064, modDate: 1399455064, value: "L23" } ], creDate: 1399455064, modDate: 1399455064 }'
T@09:31:04  ContextAttribute[42]: Creating a ContextAttribute 1
T@09:31:04  ContextAttribute[86]: Creating a ContextAttribute 'temperature':'degree':'11', setting its compound to NULL
T@09:31:04  ContextAttribute[42]: Creating a ContextAttribute 1
T@09:31:04  ContextAttribute[86]: Creating a ContextAttribute 'lightstatus':'light':'L23', setting its compound to NULL
T@09:31:04  reqSemGive[104]: mongoQueryContext gives the 'req' semaphore for 'ngsi10 query request'
T@09:31:04  ~QueryContextResponse[64]: destroyed
T@09:31:04  restReply[65]: Response 3: responding with 810 bytes, Status Code 200
T@09:31:04  restReply[66]: Response payload: '<queryContextResponse>
  <contextResponseList>
    <contextElementResponse>
      <contextElement>
        <entityId type="Room" isPattern="false">
          <id>entity01</id>
        </entityId>
        <contextAttributeList>
          <contextAttribute>
            <name>temperature</name>
            <type>degree</type>
            <contextValue>11</contextValue>
          </contextAttribute>
          <contextAttribute>
            <name>lightstatus</name>
            <type>light</type>
            <contextValue>L23</contextValue>
          </contextAttribute>
        </contextAttributeList>
      </contextElement>
      <statusCode>
        <code>200</code>
        <reasonPhrase>OK</reasonPhrase>
      </statusCode>
    </contextElementResponse>
  </contextResponseList>
</queryContextResponse>
'
T@09:31:04  ~RegisterContextResponse[56]: destroyed
T@09:31:04  httpHeaderGet[94]: HTTP Header:   User-Agent: curl/7.26.0
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Host: localhost:9999
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Accept: */*
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Content-Type: application/xml
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Content-Length: 1532
T@09:31:04  httpHeaderGet[94]: HTTP Header:   Expect: 100-continue
T@09:31:04  restService[135]: Parsing payload for URL '/ngsi10/subscribeContext', method 'POST', service vector index: 16
T@09:31:04  payloadParse[53]: parsing data for service 'SubscribeContextRequest'. Method: 'POST'
T@09:31:04  payloadParse[54]: outFormat: XML
T@09:31:04  payloadParse[58]: Calling xmlTreat for service request 12, payloadWord 'subscribeContextRequest'
2@09:31:04  xmlRequestGet[155]: Found xmlRequest of type 12, method 'POST' - index 16 (/subscribeContextRequest)
T@09:31:04  nullTreat[272]: Not treating node 'subscribeContextRequest'
T@09:31:04  nullTreat[272]: Not treating node 'entityIdList'
T@09:31:04  entityId[53]: Got an entityId
T@09:31:04  entityIdParse[291]: Got a type for an entity: 'Room'
T@09:31:04  entityIdParse[296]: Got an isPattern for an entity: 'false'
T@09:31:04  entityIdId[77]: Got an entityId:id: 'ConferenceRoom'
T@09:31:04  entityId[53]: Got an entityId
T@09:31:04  entityIdParse[291]: Got a type for an entity: 'Room'
T@09:31:04  entityIdParse[296]: Got an isPattern for an entity: 'false'
T@09:31:04  entityIdId[77]: Got an entityId:id: 'OfficeRoom'
T@09:31:04  nullTreat[272]: Not treating node 'attributeList'
T@09:31:04  attribute[90]: Got an attribute
T@09:31:04  attribute[90]: Got an attribute
T@09:31:04  reference[351]: Got a reference: 'http://127.0.0.1:1028'
T@09:31:04  duration[364]: Got a duration: 'P5Y'
T@09:31:04  restriction[104]: Got a restriction
T@09:31:04  attributeExpression[118]: Got an attributeExpression: 'testRestriction'
T@09:31:04  nullTreat[272]: Not treating node 'scope'
T@09:31:04  operationScope[134]: Got an operationScope
T@09:31:04  scopeType[149]: Got a scopeType: 'scope1'
T@09:31:04  scopeValue[176]: Got a scopeValue: 'sval1' for scopeType 'scope1'
T@09:31:04  operationScope[134]: Got an operationScope
T@09:31:04  scopeType[149]: Got a scopeType: 'scope2'
T@09:31:04  scopeValue[176]: Got a scopeValue: 'sval2' for scopeType 'scope2'
T@09:31:04  operationScope[134]: Got an operationScope
T@09:31:04  scopeType[149]: Got a scopeType: 'FIWARE_Location'
T@09:31:04  scopeValue[171]: Preparing scopeValue for 'FIWARE_Location'
T@09:31:04  circle[190]: Got a circle
T@09:31:04  circleRadius[230]: Got a circleRadius: 11
T@09:31:04  circleCenterLatitude[203]: Got a circleCenterLatitude: 55
T@09:31:04  circleCenterLongitude[217]: Got a circleCenterLongitude: 55
T@09:31:04  circleInverted[243]: Got a circleInverted: 0
T@09:31:04  nullTreat[272]: Not treating node 'notifyConditions'
T@09:31:04  notifyCondition[376]: Got a Notify Condition
T@09:31:04  notifyConditionType[404]: Got a Notify Condition Type: 'ONCHANGE'
T@09:31:04  nullTreat[272]: Not treating node 'condValueList'
T@09:31:04  condValue[417]: Got a Cond Value: 'temperature'
T@09:31:04  condValue[417]: Got a Cond Value: 'lightstatus'
T@09:31:04  notifyConditionRestriction[390]: Got a Notify Condition restriction
T@09:31:04  throttling[430]: Got a throttling: 'P5Y'
T@09:31:04  xmlTreat[251]: Calling check for XML parsed tree (subscribeContextRequest)
T@09:31:04  check[45]: In Restriction::check
T@09:31:04  check[59]: Restriction::check returns OK (2)
T@09:31:04  ~SubscribeContextResponse[38]: destroyed
T@09:31:04  payloadParse[69]: result: 'OK'
T@09:31:04  payloadParse[70]: outFormat: XML
T@09:31:04  restService[138]: payloadParse returns 'OK'
T@09:31:04  restService[153]: Treating service POST /ngsi10/subscribeContext
T@09:31:04  reqSemTake[75]: mongoSubscribeContext taking the 'req' semaphore for 'ngsi10 subscribe request'
T@09:31:04  reqSemTake[77]: mongoSubscribeContext has the 'req' semaphore
T@09:31:04  mongoSubscribeContext[46]: Subscribe Context Request
T@09:31:04  mongoSubscribeContext[57]: Subscription expiration: 1557135064
T@09:31:04  processEntitityPatternFalse[486]: Entity query token (isPattern=false): {id: ConferenceRoom, type: Room}
T@09:31:04  processEntitityPatternFalse[486]: Entity query token (isPattern=false): {id: OfficeRoom, type: Room}
T@09:31:04  entitiesQuery[702]: Attribute query token: 'temperature'
T@09:31:04  entitiesQuery[702]: Attribute query token: 'lightstatus'
T@09:31:04  entitiesQuery[742]: query() in 'testharness.entities' collection: '{ $or: [ { _id: { $in: [ { id: "ConferenceRoom", type: "Room" }, { id: "OfficeRoom", type: "Room" } ] } } ], attrs.name: { $in: [ "temperature", "lightstatus" ] } }'
T@09:31:04  mongoSemTake[90]: entitiesQuery taking the 'mongo' semaphore for 'query in EntitiesCollection'
T@09:31:04  mongoSemTake[92]: entitiesQuery has the 'mongo' semaphore
T@09:31:04  mongoSemGive[118]: entitiesQuery gives the 'mongo' semaphore for 'query in EntitiesCollection'
T@09:31:04  mongoSubscribeContext[108]: insert() in 'testharness.csubs' collection: '{ _id: ObjectId('5369fd5880948afb2d671cf2'), expiration: 1557135064, reference: "http://127.0.0.1:1028", throttling: 157680000, entities: [ { id: "ConferenceRoom", type: "Room", isPattern: "false" }, { id: "OfficeRoom", type: "Room", isPattern: "false" } ], attrs: [ "temperature", "lightstatus" ], conditions: [ { type: "ONCHANGE", value: [ "temperature", "lightstatus" ] } ], format: "XML" }'
T@09:31:04  mongoSemTake[90]: mongoSubscribeContext taking the 'mongo' semaphore for 'insert into SubscribeContextCollection'
T@09:31:04  mongoSemTake[92]: mongoSubscribeContext has the 'mongo' semaphore
T@09:31:04  mongoSemGive[118]: mongoSubscribeContext gives the 'mongo' semaphore for 'insert into SubscribeContextCollection'
T@09:31:04  reqSemGive[104]: mongoSubscribeContext gives the 'req' semaphore for 'ngsi10 subscribe request'
T@09:31:04  ~SubscribeContextResponse[38]: destroyed
T@09:31:04  restReply[65]: Response 4: responding with 224 bytes, Status Code 200
T@09:31:04  restReply[66]: Response payload: '<subscribeContextResponse>
  <subscribeResponse>
    <subscriptionId>5369fd5880948afb2d671cf2</subscriptionId>
    <duration>P5Y</duration>
    <throttling>P5Y</throttling>
  </subscribeResponse>
</subscribeContextResponse>
'
T@09:31:04  ~RegisterContextResponse[56]: destroyed
F@09:31:04  ***[531]: In sigHandler - caught signal 15
X@09:31:04  sigHandler[537]: Received signal 15
==29857== 
==29857== Process terminating with default action of signal 11 (SIGSEGV)
==29857==  General Protection Fault
==29857==    at 0x404DB43: boost::detail::set_tss_data(void const*, boost::shared_ptr<boost::detail::tss_cleanup_function>, void*, bool) (in /usr/lib/libboost_thread.so.1.49.0)
==29857==    by 0x78A648: boost::thread_specific_ptr<mongo::LastError>::~thread_specific_ptr() (in /home/fermin/bin/contextBroker)
==29857==    by 0x5817DF1: __run_exit_handlers (exit.c:78)
==29857==    by 0x5817E44: exit (exit.c:100)
==29857==    by 0x71127F: lmOut(char*, char, char const*, int, char const*, int, char const*, bool) (logMsg.cpp:1837)
==29857==    by 0x5DE181: sigHandler(int) (contextBroker.cpp:537)
==29857==    by 0x58134EF: ??? (in /lib/x86_64-linux-gnu/libc-2.13.so)
==29857==    by 0x588D60C: ??? (syscall-template.S:82)
==29857==    by 0x588D47F: sleep (sleep.c:138)
==29857==    by 0x5DF397: main (contextBroker.cpp:740)


1 EntityIds:
Entity Id 0:
  Id:         entity01
  Type:       Room
  isPattern:  false
Attribute List
  temperature
  occupancy
  lightstatus
AttributeExpression: Attribute Expression
3 Scopes:
Scope 0:
  Type:     st1
  Value:    sv1
Scope 1:
  Type:     FIWARE_Location
  FI-WARE Circle Area:
    Radius:     10
    Longitude:  45
    Latitude:   45
    Inverted:   0
Scope 2:
  Type:     st2
  Value:    sv2


1 ContextElementsContext Element 0:
  Entity Id:
    Id:         entity01
    Type:       Room
    isPattern:  false
  No AttributeDomainName
2 ContextAttributes  Attribute 0:
    Name:       temperature
    Type:       degree
    Value:      11
0 Attribute Metadatas
  Attribute 1:
    Name:       lightstatus
    Type:       light
    Value:      L23
0 Attribute Metadatas
0 Domain Metadatas
UpdateActionType: APPEND


1 EntityIds:
Entity Id 0:
  Id:         entity01
  Type:       Room
  isPattern:  false
Attribute List
  temperature
  occupancy
  lightstatus
AttributeExpression: Attribute Expression
3 Scopes:
Scope 0:
  Type:     st1
  Value:    sv1
Scope 1:
  Type:     FIWARE_Location
  FI-WARE Circle Area:
    Radius:     10
    Longitude:  45
    Latitude:   45
    Inverted:   0
Scope 2:
  Type:     st2
  Value:    sv2
2 EntityIds:
  Entity Id 0:
    Id:         ConferenceRoom
    Type:       Room
    isPattern:  false
  Entity Id 1:
    Id:         OfficeRoom
    Type:       Room
    isPattern:  false
  Attribute List
    temperature
    lightstatus
  Reference: http://127.0.0.1:1028
  Duration: P5Y
  AttributeExpression: testRestriction
3 Scopes:
  Scope 0:
    Type:     scope1
    Value:    sval1
  Scope 1:
    Type:     scope2
    Value:    sval2
  Scope 2:
    Type:     FIWARE_Location
    FI-WARE Circle Area:
      Radius:     11
      Longitude:  55
      Latitude:   55
      Inverted:   0
1 NotifyConditions    Notify Condition 0:
    type: ONCHANGE
    ConditionValue List
      temperature
      lightstatus
    RestrictionString: restriction
  Throttling: P5Y
==29857== 
==29857== HEAP SUMMARY:
==29857==     in use at exit: 173,407 bytes in 2,609 blocks
==29857==   total heap usage: 5,721 allocs, 3,112 frees, 10,276,450 bytes allocated
==29857== 
==29857== LEAK SUMMARY:
==29857==    definitely lost: 0 bytes in 0 blocks
==29857==    indirectly lost: 0 bytes in 0 blocks
==29857==      possibly lost: 82,633 bytes in 1,532 blocks
==29857==    still reachable: 90,774 bytes in 1,077 blocks
==29857==         suppressed: 0 bytes in 0 blocks
==29857== Rerun with --leak-check=full to see details of leaked memory
==29857== 
==29857== For counts of detected and suppressed errors, rerun with: -v
==29857== Use --track-origins=yes to see where uninitialised values come from
==29857== ERROR SUMMARY: 140 errors from 34 contexts (suppressed: 7 from 7)
